<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>图片管理系统</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />    
    
    <link href="./css/bootstrap.min.css" rel="stylesheet" />
    <link href="./css/bootstrap-responsive.min.css" rel="stylesheet" />
    
    
    <link href="./css/font-awesome.css" rel="stylesheet" />
    
    <link href="./css/adminia.css" rel="stylesheet" /> 
    <link href="./css/adminia-responsive.css" rel="stylesheet" /> 
    
    <link href="./css/pages/dashboard.css" rel="stylesheet" /> 
    

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
	
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <style type="text/css">
        /*分页条样式*/
         a{color:#000;text-decoration:none;}
        .clearfix:after {clear: both;content: ".";display: block;font-size: 0;height: 0;line-height: 0;visibility: hidden;}
        .fr{float:none;}
        .page a{padding:6px 12px;border:1px solid #ddd;float:left;margin-left:-1px;color:#006dae;text-align:center;}
        .page a:hover{background:#ddd;}
        .page a.current{background:#006dae;color:#fff;border:1px solid #006dae;cursor: default;}
        .page .first{margin-right:10px;}
        .pageinfo{margin-left:10px;padding:6px 12px;border:1px solid #ddd;float:left;color:#006dae;text-align:center;}
    </style>
</head>

<body>
	
<div class="navbar navbar-fixed-top">
	
	<div class="navbar-inner">
		
		<div class="container">
			
			<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> 
				<span class="icon-bar"></span> 
				<span class="icon-bar"></span> 
				<span class="icon-bar"></span> 				
			</a>
			
			<a class="brand" href="./">图片管理系统</a>
			
			<div class="nav-collapse">
			
				<ul class="nav pull-right">
					<li class="divider-vertical"></li>
					<li class="dropdown">
						
						<a data-toggle="dropdown" class="dropdown-toggle " href="#">
							菜单 <b class="caret"></b>							
						</a>
						
						<ul class="dropdown-menu">
							<li>
								<a href="./index.html"><i class="icon-pushpin"></i>标签管理</a>
					        </li>
							<li>
								<a href="./picUpload.html"><i class="icon-th-large"></i> 图片管理</a>
							</li>
							<li>
								<a href="./usermanage.html"><i class="icon-user"></i> 用户管理 </a>
							</li>
							<li>
								<a href="./exceptionmanage.html"><i class="icon-th-list"></i>异常管理</a>
							</li>
							
							<li class="divider"></li>
							<li>
								<a href="./login.html"><i class="icon-off"></i>退出登录</a>
							</li>
						</ul>
					</li>
				</ul>
				
			</div> <!-- /nav-collapse -->
			
		</div> <!-- /container -->
		
	</div> <!-- /navbar-inner -->
	
</div> <!-- /navbar -->

<div id="content">
	
	<div class="container">
		
		<div class="row">
			
			<div class="span3">
				
				<div class="account-container">
				
					<div class="account-avatar">
						<img src="./img/headshot.jpg" alt="" class="thumbnail" />
					</div> <!-- /account-avatar -->
				
					<div class="account-details">
					
						<span class="account-name">admin</span>
						
						<span class="account-role">Administrator</span>
						
					
					</div> <!-- /account-details -->
				
				</div> <!-- /account-container -->
				
				<hr />
				
				<ul id="main-nav" class="nav nav-tabs nav-stacked">
					
					<li>
						<a href="./index.html">
							<i class="icon-pushpin"></i>
							标签管理	
						
						</a>
					</li>
					<li>
						<a href="./picUpload.html">
							<i class="icon-th-large"></i>
							图片管理
						
						</a>
					</li>
					<li>
						<a href="./usermanage.html">
							<i class="icon-user"></i>
							用户管理		
						</a>
					</li>
					<li class="active">
					<a href="./exceptionmanage.html">
							<i class="icon-th-list"></i>
							异常管理		
						</a>
					</li>
					
					
					<!-- <li> -->
					<li>
						<a href="./login.html">
							<i class="icon-off"></i>
							退出登录
						</a>
					</li>
					
				</ul>	
				
				<hr />
				<br />
		
			</div> <!-- /span3 -->
			
			
			
			<div class="span9">
				
				<h1 class="page-title">
					<i class="icon-pushpin"></i>
					异常管理					
				</h1>
					
				
				<div class="widget widget-table">
										
					<div class="widget-header">
						<i class="icon-th-list"></i>
						<h3>异常图片管理</h3>
					</div> <!-- /widget-header -->
					
					<div class="widget-content">
						<div class="table-responsive" id="tableres">
							 <table id="tb" class="table table-striped">
								<thead>
									<tr>
									<th width="90px;">图片名</th>
									<th width="240px;">天数</th>
									<th width="130px;">操作</th>
									</tr>
								</thead>
							<tbody></tbody>
							<tfoot>
								<tr>
									<td colspan="5">
										<div id="dvPager" class="page fr clearfix" style="margin: 10px 0 15px;"></div>
									</td>
								</tr>
							</tfoot>
						</table>
					</div>
					</div> <!-- /widget-content -->
					
				</div> <!-- /widget -->
				
				
				
				
				
				
				
			</div> <!-- /span9 -->
			
			
		</div> <!-- /row -->
		
	</div> <!-- /container -->
	
</div> <!-- /content -->
					
	
<div id="footer">
	
	<div class="container">				
		<hr />
		<!--<p>&copy; 2012 Go Ideate.More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a></p>-->
	</div> <!-- /container -->
	
</div> <!-- /footer -->


    

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./js/jquery-1.7.2.min.js"></script>
<script src="./js/excanvas.min.js"></script>
<script src="./js/jquery.flot.js"></script>
<script src="./js/jquery.flot.pie.js"></script>
<script src="./js/jquery.flot.orderBars.js"></script>
<script src="./js/jquery.flot.resize.js"></script>
<script src="./js/bootstrap.js"></script>
<script src="./js/charts/bar.js"></script>
<script src="Scripts/ajax-pager.js"></script>
 <script src="Scripts/jquery-1.9.0.js"></script>
 <!--
 <script type="text/javascript">
        $(function () {
            loadData(1, 10);
            //分页条点击事件
            $(document.body).on('click', '.pageNav', function() {
                var pageSize = Number(getQueryString('pageSize', $(this).attr('href')));
                var pageIndex = Number(getQueryString('pageIndex', $(this).attr('href')));
                loadData(pageIndex, pageSize);
                return false; //不跳转页面
            });
        });

        //加载数据
        function loadData(pageIndex, pageSize) {
				var data=receiveData();
				alert(data.length);
				$("#tableres").html(data);
                var beginIndex = (pageIndex - 1) * pageSize+1;
                var endIndex = pageIndex * pageSize;
                var tbodyHtml = '';
                for (var i = beginIndex; i <= endIndex; i++) {
                    if (!data[i]) {
                        break;
                    }
					var address="http://114.115.133.62:8001/download/mini_"+ data[i].picNames;
                    var tbody = '<tr><td><a target="_blank" href='+address+'>{0}</a></td><td>{1}</td><td><input type="button" value="强制推送"></td></td><';
                    tbody = tbody.format(data[i].picNames, data[i].days);
                    tbodyHtml += tbody;
                }
                $('#tb').find('tbody').first().html(tbodyHtml);
                var pageCount = parseInt(((data.length-1) / pageSize)) + ((data.length-1) % pageSize ? 1 : 0);
                $('#dvPager').html(pager(pageSize, pageIndex, pageCount, 'picname.txt'));
            }
        
        //字符串格式化
        String.prototype.format = function (args) {
            var result = this;
            var reg;
            if (arguments.length > 0) {
                if (arguments.length == 1 && typeof (args) == "object") {
                    for (var key in args) {
                        if (args[key] !== undefined) {
                            reg = new RegExp("({" + key + "})", "g");
                            result = result.replace(reg, args[key]);
                        }
                    }
                } else {
                    for (var i = 0; i < arguments.length; i++) {
                        if (arguments[i] !== undefined) {
                            reg = new RegExp("({)" + i + "(})", "g");
                            result = result.replace(reg, arguments[i]);
                        }
                    }
                }
            }
            return result;
        };
        //获取url参数
        function getQueryString(name, url) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            url = url && url.indexOf('?') >= 0 ? url.substring(url.indexOf('?'), url.length) : window.location.search;
            var r = url.substr(1).match(reg);
            if (r != null) return unescape(r[2]); return null;
        }
		function receiveData(){
			$.post("http://114.115.133.62:8001/getpicinfo/",
		   {
			requestCode:"2" 
		   },
			function(result,status,xhr){
				alert(result.length);
				return result;
			},
			"json");	
		}
    </script>
  <!--
  <script>
	$(document).ready(function(){
		picSearch();	
	function picSearch(){
		$.post("http://114.115.133.62:8001/getpicinfo/",
		{
			requestCode:"2" 
		},
		function(result,status,xhr){
		if(result.length==1)
		   alert("没有异常图片！");
		  else
			picShow(result);
		},
		"json");
	}
	function picShow(result){
		var s='<table class="table table-striped table-bordered table-hover table-condensed" id="testInfo"><thead><tr><th class="text-center">图片名</th><th class="text-center">天数</th><th>操作</th></tr></thead><tbody>';			
		for (var i=1;i<result.length;i++){
		  var address="http://114.115.133.62:8001/download/mini_"+ result[i].picNames;
		  s+='<tr><td class="text-center" id="num1">' + '<a target="_blank" href='+address+'>'+result[i].picNames+ '</a></td><td class="text-center" id="num2">' + result[i].days+ '</td><td><input type="button" value="强制推送"></td></tr>';
		}
		s+='</tbody></table>';
		$("#tableres").html(s);
		picEdit();
	}
	function  picEdit(){
		var picid;
			$("input:button").click(function() {
				$(this).parent().siblings("td").each(function() {  // 获取当前行的其他单元格
						var credit=$(this).attr("id");
						 if(credit=="num1")
						{
							picid=$(this).text();
						}	
				});
				$.post("http://114.115.133.62:8001/getpicinfo/",
				{
					requestCode:"2"
				},
				function(result,status,xhr){
					//alert(status);
				},
				"json");	
				});
			
	}
	
});
</script>-->
  </body>
</html>
